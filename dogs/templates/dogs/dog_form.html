{% extends "dogs/base.html" %}

{% block title %}{{ title }} - {{ block.super }}{% endblock %}

{% block content %}
<style>
    /* Ensure all form fields have dark theme styling */
    input[type="text"],
    input[type="email"],
    input[type="number"],
    input[type="file"],
    select,
    textarea {
        width: 100%;
        padding: 0.75rem;
        border: 2px solid rgba(59,130,246,0.2);
        border-radius: 8px;
        font-size: 1rem;
        transition: all 0.2s ease;
        background: rgba(51,65,85,0.4) !important;
        color: #e0e0e0 !important;
    }

    input[type="text"]:focus,
    input[type="email"]:focus,
    input[type="number"]:focus,
    input[type="file"]:focus,
    select:focus,
    textarea:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        background: rgba(51,65,85,0.6) !important;
    }

    select {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2360a5fa' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
        background-position: right 0.5rem center;
        background-repeat: no-repeat;
        background-size: 1.5em 1.5em;
        padding-right: 2.5rem;
    }
</style>
<div class="page-header">
    <h1 class="page-title">{{ title }}</h1>
    <p class="page-subtitle">{% if dog %}–û–±–Ω–æ–≤–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ {{ dog.name }}{% else %}–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è –Ω–æ–≤–æ–π —Å–æ–±–∞–∫–∏{% endif %}</p>
</div>

<div class="row" style="display: grid; grid-template-columns: 1fr 400px; gap: 2rem; max-width: 1000px; margin: 0 auto;">
    <!-- Form -->
    <div>
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ–±–∞–∫–µ</h3>
            </div>
            <div class="card-body">
                <form method="POST" enctype="multipart/form-data">
                    {% csrf_token %}
                    
                    <!-- Basic Information -->
                    <div style="margin-bottom: 2rem;">
                        <h4 style="margin-bottom: 1rem; color: #60a5fa;">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label class="form-label" for="{{ form.name.id_for_label }}">{{ form.name.label }}</label>
                                {{ form.name }}
                                {% if form.name.errors %}
                                    <div style="color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem;">
                                        {{ form.name.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label" for="{{ form.breed.id_for_label }}">{{ form.breed.label }}</label>
                                {{ form.breed }}
                                {% if form.breed.errors %}
                                    <div style="color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem;">
                                        {{ form.breed.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label class="form-label" for="{{ form.age.id_for_label }}">{{ form.age.label }}</label>
                                {{ form.age }}
                                {% if form.age.errors %}
                                    <div style="color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem;">
                                        {{ form.age.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label" for="{{ form.gender.id_for_label }}">{{ form.gender.label }}</label>
                                {{ form.gender }}
                                {% if form.gender.errors %}
                                    <div style="color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem;">
                                        {{ form.gender.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label class="form-label" for="{{ form.size.id_for_label }}">{{ form.size.label }}</label>
                                {{ form.size }}
                                {% if form.size.errors %}
                                    <div style="color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem;">
                                        {{ form.size.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label" for="{{ form.looking_for.id_for_label }}">{{ form.looking_for.label }}</label>
                                {{ form.looking_for }}
                                {% if form.looking_for.errors %}
                                    <div style="color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem;">
                                        {{ form.looking_for.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Character -->
                    <div style="margin-bottom: 2rem;">
                        <h4 style="margin-bottom: 1rem; color: #60a5fa;">–•–∞—Ä–∞–∫—Ç–µ—Ä</h4>
                        
                        <div class="form-group">
                            {{ form.temperament }}
                            {% if form.temperament.help_text %}
                                <small style="color: #cbd5e1; font-size: 0.875rem; margin-top: 0.25rem; display: block;">
                                    {{ form.temperament.help_text }}
                                </small>
                            {% endif %}
                            {% if form.temperament.errors %}
                                <div style="color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem;">
                                    {{ form.temperament.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Description -->
                    <div style="margin-bottom: 2rem;">
                        <h4 style="margin-bottom: 1rem; color: #60a5fa;">–û–ø–∏—Å–∞–Ω–∏–µ</h4>
                        
                        <div class="form-group">
                            {{ form.description }}
                            {% if form.description.help_text %}
                                <small style="color: #cbd5e1; font-size: 0.875rem; margin-top: 0.25rem; display: block;">
                                    {{ form.description.help_text }}
                                </small>
                            {% endif %}
                            {% if form.description.errors %}
                                <div style="color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem;">
                                    {{ form.description.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Photo -->
                    <div style="margin-bottom: 2rem;">
                        <h4 style="margin-bottom: 1rem; color: #60a5fa;">–§–æ—Ç–æ</h4>
                        
                        <div class="form-group">
                            {{ form.photo }}
                            {% if form.photo.help_text %}
                                <small style="color: #cbd5e1; font-size: 0.875rem; margin-top: 0.25rem; display: block;">
                                    {{ form.photo.help_text }}
                                </small>
                            {% endif %}
                            {% if form.photo.errors %}
                                <div style="color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem;">
                                    {{ form.photo.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        {% if dog and dog.photo %}
                            <div style="margin-top: 1rem;">
                                <p>–¢–µ–∫—É—â–µ–µ —Ñ–æ—Ç–æ:</p>
                                <img src="{{ dog.photo.url }}" alt="{{ dog.name }}" 
                                     style="width: 150px; height: 150px; object-fit: cover; border-radius: 8px;">
                            </div>
                        {% endif %}
                    </div>
                    
                    <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                        <a href="{% if dog %}{% url 'dogs:dog_detail' dog.pk %}{% else %}{% url 'dogs:dog_list' %}{% endif %}" 
                           class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</a>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-check"></i> {{ submit_button }}
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Sidebar with tips -->
    <div>
        <div class="card" style="margin-bottom: 1.5rem;">
            <div class="card-header">
                <h3 class="card-title">üí° –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã</h3>
            </div>
            <div class="card-body">
                <div style="font-size: 0.9rem; line-height: 1.6;">
                    <p><strong>–ò–º—è:</strong> –í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏—á–∫—É, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä —Å–æ–±–∞–∫–∏.</p>
                    
                    <p><strong>–ü–æ—Ä–æ–¥–∞:</strong> –£–∫–∞–∂–∏—Ç–µ —Ç–æ—á–Ω—É—é –ø–æ—Ä–æ–¥—É –¥–ª—è –ª—É—á—à–∏—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π.</p>
                    
                    <p><strong>–í–æ–∑—Ä–∞—Å—Ç:</strong> –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤.</p>
                    
                    <p><strong>–•–∞—Ä–∞–∫—Ç–µ—Ä:</strong> –û–ø–∏—à–∏—Ç–µ —Ç–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç: –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π, —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π, —Å–ø–æ–∫–æ–π–Ω—ã–π...</p>
                    
                    <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –ø—Ä–∏–≤—ã—á–∫–∞—Ö, –ª—é–±–∏–º—ã—Ö –∑–∞–Ω—è—Ç–∏—è—Ö –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è—Ö.</p>
                    
                    <p><strong>–§–æ—Ç–æ:</strong> –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ñ–æ—Ç–æ —É–≤–µ–ª–∏—á–∏—Ç —à–∞–Ω—Å—ã –Ω–∞ —É—Å–ø–µ—à–Ω–æ–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ!</p>
                </div>
            </div>
        </div>
        
        {% if not dog %}
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">üéØ –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è</h3>
            </div>
            <div class="card-body">
                <p style="font-size: 0.9rem; color: #666; margin-bottom: 1rem;">
                    –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è –≤—ã —Å–º–æ–∂–µ—Ç–µ:
                </p>
                <ul style="font-size: 0.9rem; color: #666; padding-left: 1rem;">
                    <li>–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ –¥—Ä—É–≥–∏—Ö —Å–æ–±–∞–∫</li>
                    <li>–û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –º—ç—Ç—á–∏</li>
                    <li>–î–æ–±–∞–≤–ª—è—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</li>
                    <li>–û–±—â–∞—Ç—å—Å—è —Å –≤–ª–∞–¥–µ–ª—å—Ü–∞–º–∏</li>
                </ul>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<script>
// Image preview functionality
document.getElementById('id_photo').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            let preview = document.getElementById('image-preview');
            if (!preview) {
                preview = document.createElement('div');
                preview.id = 'image-preview';
                preview.style.marginTop = '1rem';
                e.target.parentNode.appendChild(preview);
            }
            preview.innerHTML = `
                <p>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ç–æ:</p>
                <img src="${e.target.result}" style="width: 200px; height: 200px; object-fit: cover; border-radius: 8px;">
            `;
        };
        reader.readAsDataURL(file);
    }
});
</script>
{% endblock %}